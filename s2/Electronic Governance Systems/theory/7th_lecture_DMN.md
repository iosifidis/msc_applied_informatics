# *«Εισαγωγή στη DMN»*
---

## 📘 Κεφάλαιο 3: Μοντελοποίηση Αποφάσεων με DMN

---

## 🔷 1. Εισαγωγή στη DMN
- Η **DMN** είναι πρότυπο της **OMG** (Object Management Group) από το **2015**.
- Η πιο πρόσφατη έκδοση είναι η **1.5 (beta)**.
- Στόχος: Να παρέχει **κατανοητά και εκτελέσιμα μοντέλα λήψης αποφάσεων** που γεφυρώνουν τη θεωρία και την υλοποίηση.
- Δυνατότητα έκφρασης σε **XML**, χρήσιμη για προγραμματιστές.

---

## 🔷 2. Συνδυασμός με άλλα πρότυπα
DMN συμπληρώνει:
- **BPMN** → για τη μοντελοποίηση της επιχειρηματικής ροής (process logic).
- **PRR, PMML** → για τη λογική των αποφάσεων (decision logic).

➡️ Όμως, αυτά δεν επαρκούν για να αποδώσουν τη **δομή** των αποφάσεων ➝ γι’ αυτό δημιουργήθηκε το **DRD (Decision Requirements Diagram)**.

---

## 🔷 3. Επίπεδα Μοντελοποίησης DMN

### 🧩 Α. Επιχειρησιακή Ροή – BPMN
Καθορίζει πού απαιτείται η λήψη απόφασης (π.χ., **Business Rule Task**).

### 🧩 B. Απόφαση – DRD (Decision Requirements Diagram)
Προσδιορίζει:
- Τις αποφάσεις που λαμβάνονται.
- Τις μεταξύ τους σχέσεις.
- Τις **εισροές** και **πηγές γνώσης**.

### 🧩 Γ. Λογική Απόφασης – Decision Logic
- Καθορίζει **πώς** προκύπτει μια απόφαση από τα δεδομένα εισόδου.
- Περιλαμβάνει **πίνακες αποφάσεων**, **κανόνες**, **υπολογισμούς**, **if/then/else**, μέσω της γλώσσας **FEEL**.

---

## 🔷 4. Βασικές Έννοιες

### 🔹 DRD (Decision Requirements Diagram)
- Δείχνει τις **εξαρτήσεις** μεταξύ αποφάσεων, δεδομένων και γνώσεων.
- Υποστηρίζει **υποαποφάσεις** (π.χ., απόφαση που εξαρτάται από άλλη).
- Χρησιμοποιεί **Business Knowledge Models** και **Knowledge Sources**.

### 🔹 DRG (Decision Requirements Graph)
- Αποτελεί **ένα ή περισσότερα DRD**.
- Είναι **αυτοτελές** και αναπαριστά πλήρως τις απαιτήσεις όλων των αποφάσεων ενός συστήματος.

---

## 🔷 5. Είδη Απαιτήσεων (Requirements)

| Είδος | Περιγραφή |
|-------|-----------|
| **Information Requirement** | Εξάρτηση μιας απόφασης από εισόδους ή άλλες αποφάσεις. |
| **Knowledge Requirement** | Εξάρτηση από μοντέλα επιχειρηματικής γνώσης ή decision services. |
| **Authority Requirement** | Εξάρτηση από πηγές γνώσης (νομοθεσία, κανονισμοί, πολιτικές κλπ). |

---

## 🔷 6. Τεχνουργήματα DRD (Artifacts)
| Τεχνικό Στοιχείο | Ρόλος |
|------------------|-------|
| **Text Annotation** | Επεξηγηματικό κείμενο |
| **Association** | Διακεκομμένη γραμμή σύνδεσης |
| **Group** | Οπτική ομαδοποίηση στοιχείων |

➡️ Δεν επηρεάζουν τη λογική του μοντέλου. Χρησιμοποιούνται για **καλύτερη κατανόηση**, με φειδώ.

---

## 🔷 7. Decision Services (Υπηρεσίες Απόφασης)
- Παρέχουν **επαναχρησιμοποιήσιμη** λογική.
- Μπορούν να καλούνται **εσωτερικά** ή **εξωτερικά** (από BPMN).
- Ενθυλακώνουν (encapsulate) άλλες αποφάσεις.
- Διακρίνονται σε:
  - **Expanded form** – εμφανίζονται πλήρως.
  - **Collapsed form** – συντομογραφημένες, χωρίς λεπτομέρειες.

**Διεπαφή Υπηρεσίας Απόφασης:**
1. Δεδομένα εισόδου
2. Εισερχόμενες αποφάσεις (εξωτερικές)
3. Εξερχόμενες αποφάσεις (αποτέλεσμα)

---

## 🔷 8. Σημειογραφία DMN – DRD Elements

| Συστατικό | Περιγραφή |
|-----------|-----------|
| **Decision** | Αποφάσεις |
| **Input Data** | Δεδομένα εισόδου |
| **Business Knowledge Model** | Μοντέλα γνώσης |
| **Knowledge Source** | Πηγές γνώσης (έγγραφα, αρχές) |
| **Decision Service** | Επαναχρησιμοποιούμενες υπηρεσίες |

---

## 🔷 9. Πίνακες Συνδέσεων
Καθορίζουν ποια στοιχεία συνδέονται μεταξύ τους και με τι είδους **απαίτηση (requirement)**. Π.χ.:
- Decision → Decision: **Πληροφορία**
- Decision → Knowledge Source: **Αρχή**
- Input Data → Decision: **Πληροφορία**

Ο πίνακας αυτός επιτρέπει **ορθολογική σχεδίαση** διαγραμμάτων DRD.

---

## 📌 Συμπεράσματα
- Η DMN **συμπληρώνει** τη BPMN, εστιάζοντας στις **αποφάσεις**.
- Παρέχει **σαφή δομή** για την περιγραφή, εκτέλεση και διαχείριση decision logic.
- Υποστηρίζεται από εργαλεία (π.χ. Camunda).
- Χρησιμοποιείται τόσο σε **ανάλυση** όσο και σε **αυτοματοποίηση** διαδικασιών.

---

# *«Εισαγωγή στη DMN (pt. II)»*
---

## 📘 Κεφάλαιο 3.3 – Επίπεδο Λογικής Απόφασης (Decision Logic Level)

---

## 🔷 1. Έκφραση Τιμής (Value Expression)
- Κάθε απόφαση συνοδεύεται από μια **έκφραση τιμής**, η οποία περιγράφει **πώς τα input οδηγούν στο output**.
- Οι εκφράσεις τιμής χρησιμοποιούν τη γλώσσα **FEEL**.
- Τρεις τρόποι μοντελοποίησης decision logic:
  1. **Literal Expression** (π.χ. `age < 30`)
  2. **Decision Table**
  3. **Invocation** (επίκληση decision service ή knowledge model)

---

## 🔷 2. Boxed Expressions και Συναρτήσεις
- Τα **Business Knowledge Models (BKMs)** λειτουργούν ως **συναρτήσεις** (functions).
- Επιτρέπουν επαναχρησιμοποίηση της ίδιας λογικής σε πολλές αποφάσεις.
- Γράφονται με **boxed expression** για γραφική αναπαράσταση.
- Υποστηρίζουν και πίνακες αποφάσεων ως μέρος τους.

---

## 🔷 3. Μεταβλητές (Variables)
- Αντιστοιχούν σε **εισροές** και **τιμές αποφάσεων**.
- Συνδέονται μέσω **Information Requirements**.
- Σε BKMs, οι μεταβλητές είναι οι **παράμετροι** της συνάρτησης.

---

## 🔷 4. Πίνακες Αποφάσεων (Decision Tables)

### 📌 Βασικά Στοιχεία Πίνακα:
- **Input entries**: Τιμές/κανόνες εισόδου
- **Output entries**: Τιμές εξόδου
- **Rules**: Οι γραμμές ή στήλες που συνδυάζουν input & output
- **Hit Policy**: Πώς επιλέγεται η τελική απόφαση (π.χ. μοναδική ή συλλογή)
- **Annotations**: Προαιρετικά σχόλια ανά κανόνα

### 📌 Παραδείγματα Προσανατολισμού:
- Οριζόντιος: Κανόνες σε **γραμμές** (πιο κοινός τρόπος)
- Κάθετος: Κανόνες σε **στήλες**

### 📌 Συγχώνευση Κελιών:
- Δυνατότητα συγχώνευσης input με ίδια τιμή (όχι output).
  
### 📌 Χρήση του «-»:
- Σημαίνει **οποιαδήποτε τιμή** για εκείνο το πεδίο.

---

## 🔷 5. Αναφορές Δεδομένων
- Εκφράσεις τύπου: `age < 25`, `Customer == "bronze"`.
- Τα input πρέπει να καλύπτουν **όλους τους πιθανούς συνδυασμούς** για να θεωρείται πλήρης ο πίνακας.

---

## 🔷 6. Hit Policy – Πολιτικές Επιλογής Κανόνων

### ✅ **Unique (U)** – Ακριβώς ένας κανόνας ενεργοποιείται
- Δεν επιτρέπεται επικάλυψη.
- Παράδειγμα: Αν `age > 60` και `medical history = good`, τότε `Risk = Medium`.

### ✅ **Any (A)** – Επιτρέπεται επικάλυψη αλλά όλοι οι κανόνες δίνουν **ίδιο αποτέλεσμα**.
- Αν δύο κανόνες ταιριάζουν, πρέπει να καταλήγουν στο ίδιο output.

### ✅ **Collect (C)** – Συλλογή όλων των αποτελεσμάτων
- **C+** (sum): άθροισμα
- **C<** (min): ελάχιστο
- **C>** (max): μέγιστο
- **C#** (count): αριθμός κανόνων που ταιριάζουν

### ⚠️ Μη προτεινόμενες πολιτικές:
- **First (F)**: εξαρτάται από τη σειρά των κανόνων (κακή πρακτική)
- **Rule Order / Output Order**: εξαρτώνται από την ακολουθία — να αποφεύγονται αν δεν είναι απαραίτητο.

---

## 🔷 7. Παραδείγματα Χρήσης Hit Policies

### ✅ Unique
- Πλήρης πίνακας χωρίς επικαλύψεις.
- Αν υπάρχουν επικαλυπτόμενοι κανόνες ⇒ **σφάλμα**.

### ✅ Any
- Επιτρέπονται επικαλύψεις μόνο όταν τα outputs είναι **ίδια**.
- Αν όχι ⇒ **σφάλμα**.

### ✅ Collect
- Χρήσιμο όταν θέλουμε να πάρουμε **όλα τα αποτελέσματα** ή κάποια **συνάρτηση τους** (άθροισμα, πλήθος, μέγιστο κλπ).
- Αν τα output είναι μη αριθμητικά ⇒ δεν επιτρέπεται χρήση `C+`, `C<`, `C>`.

---

## 🔷 8. Γλώσσα Εκφράσεων – FEEL

- **Friendly Enough Expression Language**
- Εμπνευσμένη από: Java, SQL, JavaScript κ.ά.
- Τύποι δεδομένων που υποστηρίζονται:
  - `number`, `string`, `boolean`
  - `date`, `time`, `duration`, `range`
  - `list`, `function`, `context`

### 📌 Παραδείγματα:
```feel
"bronze"
orderSum < 1000
10 < age <= 20
```

---

## 🔷 9. Παράδειγμα Decision Table με FEEL
| Customer Status | Order Sum | Check Result | Reason                |
|------------------|------------|----------------|------------------------|
| bronze           | –          | notok         | work on your...       |
| silver           | <1000      | ok            | you little fish...    |
| silver           | >=1000     | notok         | you took too much...  |

- **Hit Policy**: Unique (U)
- Παρατηρούμε χρήση string, αριθμών, του `-` και λογικής FEEL.

---

## 📌 Συνοψίζοντας

| Έννοια | Περιγραφή |
|--------|-----------|
| **Value Expression** | Πώς προκύπτει η απόφαση |
| **Boxed Expression** | Γραφική αναπαράσταση συνάρτησης |
| **Decision Table** | Κανόνες με inputs & outputs |
| **Hit Policy** | Τρόπος επιλογής αποτελέσματος |
| **FEEL** | Γλώσσα για διατύπωση λογικής αποφάσεων |

