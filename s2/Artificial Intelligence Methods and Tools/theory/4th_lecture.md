### **Μηχανές Πεπερασμένων Καταστάσεων (FSM) και Περιορισμός Regular**  

---

#### **1. Εισαγωγή στις Μηχανές Πεπερασμένων Καταστάσεων (FSM)**  
- **Ορισμός**:  
  - Τα FSM είναι μαθηματικά μοντέλα που αποτελούνται από ένα πεπερασμένο σύνολο καταστάσεων, μεταβάσεις μεταξύ τους (βάσει συμβόλων εισόδου), μια αρχική κατάσταση και τελικές καταστάσεις.  
  - Χρησιμοποιούνται για την αναγνώριση συμβολοσειρών που ανήκουν σε μια **κανονική γλώσσα**.  

- **Τύποι FSM**:  
  - **Ντετερμινιστικά (DFA)**: Για κάθε κατάσταση και σύμβολο, υπάρχει ακριβώς μια μετάβαση.  
  - **Μη-Ντετερμινιστικά (NFA)**: Επιτρέπονται πολλαπλές μεταβάσεις για το ίδιο σύμβολο.  
  - **NFA με κενές μεταβάσεις (ε-NFA)**: Επιτρέπονται μεταβάσεις χωρίς κατανάλωση συμβόλου.  

- **Ισοδυναμία**: Όλοι οι τύποι είναι ισοδύναμοι ως προς την υπολογιστική ικανότητα.  

---

#### **2. Ντετερμινιστικά Πεπερασμένα Αυτόματα (DFA)**  
- **Στοιχεία DFA**:  
  - **Q**: Σύνολο καταστάσεων.  
  - **Σ**: Αλφάβητο εισόδου.  
  - **δ**: Συνάρτηση μετάβασης (π.χ., δ(q₁, a) = q₂).  
  - **q₀**: Αρχική κατάσταση.  
  - **F**: Τελικές καταστάσεις.  

- **Λειτουργία**:  
  1. Ξεκινά από την αρχική κατάσταση.  
  2. Καταναλώνει σύμβολα εισόδου και αλλάζει κατάσταση σύμφωνα με τη συνάρτηση δ.  
  3. Αποδέχεται τη συμβολοσειρά αν η τελική κατάσταση ανήκει στο F.  

**Παράδειγμα**:  
- Αλφάβητο: {a, b}, Καταστάσεις: {0, 1, 2, 3}, Αρχική: 1, Τελική: {3}.  
- Μεταβάσεις:  
  - δ(1, a) = 2, δ(1, b) = 0  
  - δ(2, a) = 2, δ(2, b) = 3  
  - δ(3, a) = 0, δ(3, b) = 3  

---

#### **3. Εφαρμογή σε Πρόβλημα Crew Rostering**  
**Περιγραφή Προβλήματος**:  
- **Βάρδιες**: day (πρωινή), ngt (νυκτερινή), off (ρεπό).  
- **Περιορισμοί**:  
  - Κάθε φρουρός πρέπει να έχει ακριβώς 2 νυκτερινές βάρδιες.  
  - Κάθε μέρα: τουλάχιστον 4 πρωινές και 2 νυκτερινές βάρδιες.  
  - **Κανόνες ακολουθίας βαρδιών**:  
    - Δεν ξεκινά με off.  
    - Μετά από ngt ή 3 day, ακολουθεί off.  
    - Μετά από off, ακολουθεί day ή ngt.  

**Μοντελοποίηση με FSM**:  
- **Καταστάσεις**:  
  - 1: Αρχική ή μετά από off.  
  - 2: Μετά από 1 day.  
  - 3: Μετά από 2 day.  
  - 4: Μετά από ngt ή 3 day.  
- **Μεταβάσεις**:  
  | State | day | ngt | off |  
  |-------|-----|-----|-----|  
  | 1     | 2   | 4   | <>  |  
  | 2     | 3   | 4   | <>  |  
  | 3     | 4   | <>  | 1   |  
  | 4     | <>  | <>  | 1   |  

---

#### **4. Υλοποίηση στη MiniZinc**  
**Κώδικας**:  
```minizinc
enum SHIFT = {day, ngt, off};
array[STATE, SHIFT] of opt STATE: allowed = 
  [| 2, 4, <>  % State 1
   | 3, 4, <>  % State 2
   | 4, <>, 1  % State 3
   | <>, <>, 1|]; % State 4

constraint forall(g in GUARD)(
  regular(row(roster, g), allowed, 1, STATE)
);
```

**Περιορισμοί**:  
- **Απαριθμητικοί**:  
  ```minizinc
  constraint forall(g in GUARD)(count_eq([roster[g,d] | d in PERIOD], ngt, 2));
  ```  
- **Global Cardinality**:  
  ```minizinc
  constraint forall(d in PERIOD)(
    global_cardinality([roster[g,d] | g in GUARD], [day, ngt, off], row(count_shifts, d))
  );
  ```

---

#### **5. Περιορισμός Regular και Διάδοση**  
- **Σκοπός**: Εξασφαλίζει ότι μια ακολουθία τιμών (π.χ., βάρδιες) είναι αποδεκτή από το FSM.  
- **Αλγόριθμος**:  
  1. Κατασκευή γράφου με επίπεδα (κάθε επίπεδο αντιστοιχεί σε μια θέση της ακολουθίας).  
  2. Διαγραφή ακμών που δεν οδηγούν σε τελική κατάσταση.  
  3. Εφαρμογή **συνέπειας τόξου (AC)** για περιορισμό των τιμών των μεταβλητών.  

**Παράδειγμα**:  
- Αν η τιμή `b` διαγραφεί από τη μεταβλητή `X₂`, ενημερώνονται οι δυνατές καταστάσεις στα υπόλοιπα επίπεδα.  

---

#### **6. Συμπεράσματα**  
- Τα FSM και ο περιορισμός `regular` είναι ισχυρά εργαλεία για μοντελοποίηση προβλημάτων με γραμματικούς περιορισμούς (π.χ., προγραμματισμός βαρδιών).  
- Η MiniZinc προσφέρει έτοιμες λύσεις για την εφαρμογή αυτών των εννοιών, με βελτιστοποιήσεις όπως οι global constraints.  

**Επιπλέον Ανάγνωση**:  
- Κεφάλαιο 3: "Finite Automata" από το βιβλίο "Introduction to the Theory of Computation" (Sipser).  
- Επίσημη τεκμηρίωση της MiniZinc για τους περιορισμούς `regular` και `global_cardinality`.  

---  
**Ονοματεπώνυμο Καθηγητή**  
**Τμήμα Εφαρμοσμένης Πληροφορικής, ΠΑΜΑΚ**
