# Playing Sound Effects

Η δομή αυτής της ενότητας είναι: **Αναπαραγωγή αρχείων & πόρων ήχου wave -> Χρήση Media Player για αναπαραγωγή μουσικής -> Αναπαραγωγή αρχείων MP3 & MIDI**. Θα δούμε διάφορους τρόπους για την ενσωμάτωση ήχου στις εφαρμογές μας.

---

## Ηχητικά Εφέ και Μουσική στα Παιχνίδια (Slide 2)

*   Η χρήση **ηχητικών εφέ** και **μουσικής** είναι απαραίτητη ακόμα και στο πιο απλό παιχνίδι.
*   Τα ηχητικά εφέ **σηματοδοτούν σημαντικά συμβάντα** κατά την εξέλιξη του παιχνιδιού (π.χ., χτύπημα, έκρηξη, συλλογή αντικειμένου, λάθος).
*   Το **κατάλληλο μουσικό υπόβαθρο** διατηρεί το ενδιαφέρον των παικτών.
*   Η **αλλαγή του μουσικού υπόβαθρου** ανάλογα με διαφορετικές καταστάσεις (π.χ., δράση, ηρεμία, μενού, νίκη) δημιουργεί στον παίκτη πιο έντονα συναισθήματα και ενισχύει την εμβύθιση.

---

## Αναπαραγωγή Ηχητικών Εφέ με την κλάση SoundPlayer (.wav αρχεία) (Slides 3-11)

*   Για την αναπαραγωγή **απλών ηχητικών εφέ** (συνήθως σε μορφή αρχείων `.wav`), μπορούμε να χρησιμοποιήσουμε την κλάση **`System.Media.SoundPlayer`** στο .NET Framework (C#).
*   **AudioPlaybackDemo (Slide 3):** Το παράδειγμα δείχνει ένα απλό παράθυρο με κουμπιά που παίζουν διάφορα ηχητικά εφέ συστήματος ή από αρχεία.
*   **Φόρτωση Αρχείου Ήχου (Slide 4):**
    *   Η κλάση `SoundPlayer` χρησιμοποιείται για την αναπαραγωγή ήχου.
    *   Το όνομα του αρχείου ήχου (.wav) μπορεί να περάσει ως όρισμα στον **κατασκευαστή** της κλάσης: `new SoundPlayer("filename.wav")`.
    *   Εναλλακτικά, μπορούμε να ορίσουμε την ιδιότητα **`SoundLocation`** του αντικειμένου τύπου `SoundPlayer` για τον καθορισμό του αρχείου ήχου: `sound.SoundLocation = "filename.wav";`.
    *   Η μέθοδος **`Load()`** χρησιμοποιείται για τη φόρτωση του αρχείου ήχου στη μνήμη.
    *   Για την ασφαλή φόρτωση, είναι καλό να χρησιμοποιήσουμε ένα μπλοκ **`try...catch`** για να χειριστούμε πιθανά σφάλματα (π.χ., αν το αρχείο δεν βρεθεί).
    *   Στο παράδειγμα (Slide 4), ορίζεται μια μέθοδος `LoadSoundFile(string filename)` που επιστρέφει ένα αντικείμενο `SoundPlayer`.

*   **Προσθήκη Αρχείου Ήχου στους Πόρους (Resources) του Παιχνιδιού (Slides 5-7):**
    *   Ένα καλό πρακτικό tip είναι να ενσωματώσουμε τα αρχεία ήχου στους **πόρους (resources)** του εκτελέσιμου αρχείου του παιχνιδιού.
    *   **Πλεονέκτημα:** Τα αρχεία ήχου ενσωματώνονται στο `.exe` και δεν χρειάζεται να τα διανείμουμε ως ξεχωριστά αρχεία, ούτε εκτίθενται στον χρήστη.
    *   **Πώς γίνεται (στο Visual Studio):**
        1.  Στο Solution Explorer, κάντε δεξί κλικ στο project, επιλέξτε `Add` -> `New Item...` (Slide 6, βήμα 1).
        2.  Στο παράθυρο Add New Item, επιλέξτε `General` -> `Resources File` (ή `Resource File` ανάλογα την έκδοση) και δώστε του όνομα (π.χ., `Resource1.resx`) (Slide 6, βήμα 2).
        3.  Στο παράθυρο του Resource File (π.χ., `Resource1.resx`), επιλέξτε να προσθέσετε ένα Audio resource (Slide 7, βήμα 4) και διαλέξτε το αρχείο `.wav` (π.χ., `foom.wav`).
        4.  Τώρα, το αρχείο ήχου είναι προσβάσιμο μέσω της ιδιότητας **`Properties.Resources`** (Slide 7, βήμα 5, 6).
    *   **Αναπαραγωγή από πόρους (Slide 7):** Για να αναπαράγουμε τον ήχο από τους πόρους, δημιουργούμε ένα `SoundPlayer` και αναθέτουμε στην ιδιότητα **`Stream`** του αντικειμένου το resource stream του ήχου: `audio.Stream = Properties.Resources.foom;`.

*   **Ενσωματωμένοι Ήχοι Συστήματος (Slide 8):**
    *   Το πακέτο (`namespace`) **`System.Media`** περιλαμβάνει την κλάση **`SystemSounds`**.
    *   Αυτή η κλάση μας δίνει πρόσβαση σε ενσωματωμένους ήχους του συστήματος (Asterisk, Beep, Exclamation, Hand, Question) που μπορούν να αναπαραχθούν **χωρίς καμία προεργασία** (φόρτωση).
    *   Απλά καλέστε την μέθοδο `Play()` για τον αντίστοιχο ήχο: `SystemSounds.Asterisk.Play();`.

*   **Παράδειγμα Φόρτωσης και Αναπαραγωγής Ήχων (Slides 9-11):**
    *   Στο AudioPlaybackDemo (Slides 9-11), δημιουργείται ένας **πίνακας** αντικειμένων `System.Media.SoundPlayer[] audio;` για να αποθηκεύσει διάφορα ηχητικά εφέ.
    *   Στη μέθοδο `Form1_Load` (Slide 10), γίνεται η φόρτωση των αρχείων ήχου με διάφορους τρόπους:
        1.  Χρήση κατασκευαστή: `audio[0] = new SoundPlayer("launch1.wav");`
        2.  Χρήση ιδιότητας `SoundLocation` και μεθόδου `Load()`: `audio[1] = new SoundPlayer(); audio[1].SoundLocation = "launch2.wav"; audio[1].Load();`
        3.  Χρήση της βοηθητικής μεθόδου `LoadSoundFile` (βλ. Slide 4): `audio[2] = LoadSoundFile("missed1.wav"); audio[3] = LoadSoundFile("laser.wav");`
        4.  Φόρτωση από πόρους (resources): `audio[4] = new SoundPlayer(); audio[4].Stream = Properties.Resources.foom;`
    *   Στο συμβάν **`button_Click`** (Slide 11 - ο event handler για τα κουμπιά), γίνεται ο έλεγχος του κειμένου του κουμπιού (`button.Text`) και ανάλογα καλείται η μέθοδος `Play()` είτε για τους ενσωματωμένους ήχους συστήματος είτε για τα αντικείμενα `SoundPlayer` που φορτώθηκαν από αρχεία/πόρους.

---

## Χρήση Windows Media Player (Slides 12-13)

*   Για την αναπαραγωγή **μουσικής** (αρχεία `.mp3`, `.midi` κ.λπ.) που δεν υποστηρίζεται από την απλή κλάση `SoundPlayer`, μπορούμε να χρησιμοποιήσουμε το **Windows Media Player control**.
*   **Πώς το προσθέτουμε στο Project (στο Visual Studio):**
    1.  Στο Solution Explorer, κάντε δεξί κλικ στο project, επιλέξτε `Add` -> `Reference...` (Slide 12, βήμα 1).
    2.  Στο παράθυρο Add Reference, στην καρτέλα `COM`, βρείτε και επιλέξτε `Windows Media Player` και κάντε κλικ στο `OK` (Slide 12, βήμα 2, 3).
    3.  Τώρα μπορείτε να δημιουργήσετε αντικείμενα τύπου `WindowsMediaPlayer`.
*   **Υλοποίηση (Slide 13):**
    *   Προσθέστε την απαραίτητη `using` οδηγία: `using WMPLib;`.
    *   Δηλώστε ένα πεδίο τύπου `WindowsMediaPlayer`: `WindowsMediaPlayerClass player;`.
    *   Στη μέθοδο `Form1_Load`, δημιουργήστε ένα νέο στιγμιότυπο: `player = new WindowsMediaPlayerClass();`.
    *   Ορίστε το URL (διαδρομή) του αρχείου μουσικής: `player.URL = "song.mid";` (ή `"song.mp3"` κ.λπ.). Το Windows Media Player control θα ξεκινήσει την αναπαραγωγή αυτόματα.

*   **Σημαντικό:** Το Windows Media Player control είναι ένα **ActiveX control** και η χρήση του σε εφαρμογές μπορεί να έχει κάποιες ιδιαιτερότητες ή περιορισμούς σε σύγκριση με τις "εγγενείς" κλάσεις του .NET Framework. Ωστόσο, είναι μια απλή λύση για την αναπαραγωγή μουσικής.
