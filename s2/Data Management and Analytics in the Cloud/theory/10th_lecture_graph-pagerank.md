## **Ανάλυση Μεγάλων Γράφων - PageRank & HITS**

## **1. Εισαγωγή: Συνδέσεις ως Ψήφοι (Links as Votes) (Διαφάνεια 3)**

*   **Η Κεντρική Ιδέα:** Ένας κόμβος (π.χ. ιστοσελίδα) είναι πιο σημαντικός αν έχει **περισσότερες συνδέσεις** (links).
*   **Ποιες συνδέσεις μετράνε;** Εισερχόμενες (in-coming) ή εξερχόμενες (out-going); Για την κατάταξη της σημασίας (σημασιολογικής αξίας, όχι απλής διασυνδεσιμότητας), οι **εισερχόμενες συνδέσεις (in-links)** είναι πιο σημαντικές - ένας κόμβος αποκτά "ψήφο εμπιστοσύνης" όταν κάποιος άλλος συνδέεται σε αυτόν.
*   **Είναι όλες οι εισερχόμενες συνδέσεις ίσες;** Αυτή είναι η κρίσιμη ερώτηση. Μια σύνδεση από μια "σημαντική" ιστοσελίδα (π.χ. stanford.edu) θα πρέπει να "μετράει" περισσότερο από μια σύνδεση από μια λιγότερο σημαντική (π.χ. joe-schmoe.com).
*   **Αυτό οδηγεί σε αναδρομικό (recursive) πρόβλημα:** Η σημασία ενός κόμβου εξαρτάται από τη σημασία των κόμβων που συνδέονται σε αυτόν.

## **2. PageRank: Η "Ροή" και η Αναδρομική Διατύπωση (Διαφάνειες 2, 5-7)**

*   **Ιδέα "Ροής" (Flow):** Φανταστείτε ότι κάθε κόμβος έχει μια συνολική "σημασία" ή "βαθμολογία" (rank score). Αυτή η βαθμολογία κατανέμεται εξίσου στις εξερχόμενες συνδέσεις του κόμβου. Ένας κόμβος λαμβάνει βαθμολογία από τις εισερχόμενες συνδέσεις του.
*   **Απλή Αναδρομική Διατύπωση (Simple Recursive Formulation) (Διαφάνεια 5):**
    *   Η "ψήφος" κάθε σύνδεσης είναι ανάλογη της σημασίας της πηγής της.
    *   Αν ο κόμβος `i` έχει σημασία `ri` και `di` εξερχόμενες συνδέσεις (out-links), τότε κάθε εξερχόμενη σύνδεσή του "μεταφέρει" `ri / di` ποσό σημασίας. (`di` είναι ο out-degree του κόμβου `i`).
    *   Η συνολική σημασία `rj` ενός κόμβου `j` είναι το **άθροισμα** των βαθμολογιών που λαμβάνει από όλες τις **εισερχόμενες συνδέσεις** του:
        `rj = Σ (ri / di)` για όλους τους κόμβους `i` τέτοιους ώστε `i → j`.
*   **"Ροή" στην Πράξη (Διαφάνεια 6):**
    *   Ένα "vote" από μια σημαντική σελίδα αξίζει περισσότερο.
    *   Μια σελίδα είναι σημαντική αν "δείχνεται" (is pointed to) από άλλες σημαντικές σελίδες.
    *   Ορίζουμε την **βαθμολογία (rank) rj** για τον κόμβο j.
    *   Το σύνολο αυτών των εξισώσεων για όλους τους κόμβους του γράφου ονομάζεται "Εξισώσεις Ροής" (Flow Equations).
    *   Παράδειγμα Web του 1839 (nodes y, a, m). Οι εξισώσεις ροής είναι: `ry = ry/2 + ra/2`, `ra = ry/2 + rm`, `rm = ra/2`. (Διαφάνεια 6).
*   **Επίλυση Εξισώσεων Ροής (Solving Flow Equations) (Διαφάνεια 7):**
    *   Για το παράδειγμα y-a-m, έχουμε 3 εξισώσεις, 3 αγνώστους (ry, ra, rm).
    *   **Πρόβλημα:** Αυτό το σύστημα εξισώσεων δεν έχει μοναδική λύση – έχει λύσεις που διαφέρουν κατά έναν συντελεστή κλίμακας (scale factor). Όλες οι λύσεις είναι ισοδύναμες εκτός από την κλίμακα.
    *   **Λύση:** Χρειάζεται ένας **επιπλέον περιορισμός** για να αναγκάσουμε μοναδική λύση. Ο τυπικός περιορισμός είναι ότι **το άθροισμα των PageRank scores όλων των κόμβων είναι 1** (ή το συνολικό πλήθος των κόμβων).
    *   Ακόμα και με αυτόν τον περιορισμό, η επίλυση ενός μεγάλου συστήματος εξισώσεων (με Gaussian elimination ή άλλες μεθόδους) είναι αναποτελεσματική για γράφους μεγέθους Web.

## **3. PageRank: Η Διατύπωση Πίνακα και Ιδιοδιανυσμάτων (Matrix and Eigenvector Formulation) (Διαφάνεια 8-10)**

*   Για να λύσουμε το πρόβλημα αποδοτικά, μεταφράζουμε τις εξισώσεις ροής σε **γραμμική άλγεβρα**.
*   **Στοχαστικός Πίνακας Γειτνίασης M (Stochastic Adjacency Matrix M) (Διαφάνεια 8):**
    *   Ένας πίνακας NxN (όπου Ν το πλήθος κόμβων).
    *   Η τιμή `Mji` (στοιχείο στη γραμμή j, στήλη i) ορίζεται ως `1 / di` αν υπάρχει σύνδεση `i → j`, αλλιώς `0`. Αυτό αναπαριστά την κατανομή της σημασίας: ο κόμβος `i` δίνει `1/di` της σημασίας του σε κάθε γείτονά του `j`.
    *   Αν ο γράφος δεν έχει dead ends (κόμβους χωρίς εξερχόμενες συνδέσεις), τότε οι **στήλες του πίνακα Μ αθροίζουν σε 1** (είναι "column stochastic matrix").
*   **Διάνυσμα Κατάταξης r (Rank Vector r):** Ένα διάνυσμα στήλης Nx1 όπου το στοιχείο `ri` είναι η βαθμολογία PageRank του κόμβου `i`.
*   **Εξισώσεις Ροής σε Μορφή Πίνακα (Διαφάνεια 8):** Το σύνολο των εξισώσεων `rj = Σ (ri / di)` μπορεί να γραφτεί συμπαγώς ως:
    `r = M * r`
*   **Διατύπωση Ιδιοδιανυσμάτων (Eigenvector Formulation) (Διαφάνεια 9):**
    *   Η εξίσωση `r = M * r` είναι ο ορισμός του **ιδιοδιανύσματος (eigenvector)**. Το διάνυσμα `r` είναι ιδιοδιάνυσμα του πίνακα `M`.
    *   Το αντίστοιχο **ιδιοτιμή (eigenvalue)** είναι 1. Για έναν column stochastic πίνακα χωρίς dead ends, η μεγαλύτερη ιδιοτιμή είναι 1, και το αντίστοιχο ιδιοδιάνυσμα (`r`) (με στοιχεία που αθροίζουν σε 1) είναι μοναδικό.
    *   Άρα, το διάνυσμα κατάταξης PageRank `r` είναι το **πρωτεύον ιδιοδιάνυσμα (principal eigenvector)** του στοχαστικού πίνακα M με ιδιοτιμή 1.

## **4. Επίλυση: Μέθοδος Δύναμης (Power Iteration Method) (Διαφάνειες 9, 11-13)**

*   Η εξίσωση `r = M * r` μπορεί να λυθεί αποδοτικά για μεγάλα συστήματα χρησιμοποιώντας τη **μέθοδο δύναμης (Power Iteration)**.
*   **Αλγόριθμος (Διαφάνεια 11):**
    1.  Αρχικοποίηση: Θέτουμε ένα αρχικό διάνυσμα κατάταξης `r(0)` (π.χ. ομοιόμορφα για όλους τους Ν κόμβους: `r(0) = [1/N, ..., 1/N]`).
    2.  Επανάληψη: Υπολογίζουμε την επόμενη εκδοχή του διανύσματος κατάταξης: `r(t+1) = M * r(t)`.
    3.  Σταμάτημα: Επαναλαμβάνουμε μέχρι το διάνυσμα κατάταξης να συγκλίνει, δηλαδή η διαφορά μεταξύ διαδοχικών επαναλήψεων (`|r(t+1) – r(t)|`) να γίνει μικρότερη από μια προκαθορισμένη ανοχή `ε`. Χρησιμοποιείται συνήθως η L1 norm για τη διαφορά διανυσμάτων.

**5. Ερμηνεία Τυχαίας Περιδιάβασης (Random Walk Interpretation) (Διαφάνεια 14-16)**

*   **Ιδέα:** Φανταστείτε έναν "τυχαίο σερφερ στο web" (random web surfer). Σε κάθε βήμα, ο σερφερ ακολουθεί μια εξερχόμενη σύνδεση από την τρέχουσα σελίδα `i`, επιλέγοντας την ομοιόμορφα τυχαία ανάμεσα στις `di` εξερχόμενες συνδέσεις. (Διαφάνεια 14).
*   Αν `p(t)` είναι το διάνυσμα που αναπαριστά την πιθανότητα ο σερφερ να βρίσκεται σε κάθε σελίδα τη χρονική στιγμή `t`, τότε η κατανομή πιθανότητας στην επόμενη χρονική στιγμή `t+1` είναι:
    `p(t+1) = M * p(t)` (Διαφάνεια 15)
*   Η μέθοδος δύναμης ουσιαστικά υπολογίζει την **στατική κατανομή (stationary distribution)** αυτής της τυχαίας περιδιάβασης. Αν ο σερφερ περιδιαβάζει για πολύ καιρό, η πιθανότητα να βρίσκεται σε έναν συγκεκριμένο κόμβο είναι η τιμή του κόμβου σε αυτή τη στατική κατανομή.
*   **Σημαντικό αποτέλεσμα (Θεωρία Markov Processes):** Για γράφους που πληρούν ορισμένες συνθήκες (π.χ. να είναι strongly connected και aperiodic), υπάρχει μια μοναδική στατική κατανομή, ανεξάρτητα από την αρχική κατανομή πιθανότητας (Διαφάνεια 16). Αυτό εγγυάται ότι ο PageRank υπάρχει, είναι μοναδικός και η μέθοδος δύναμης συγκλίνει.

## **6. PageRank: Προβλήματα της Απλής Διατύπωσης (Διαφάνεια 18-22, 24)**

Η απλή διατύπωση `r = M * r` έχει προβλήματα σε πραγματικούς γράφους όπως το Web:

*   **(1) Dead Ends (Νεκρά Άκρα) (Διαφάνεια 21, 24):** Κόμβοι που **δεν έχουν καμία εξερχόμενη σύνδεση**. Στον πίνακα Μ, η αντίστοιχη στήλη αποτελείται μόνο από 0.
    *   Στην τυχαία περιδιάβαση: ο σερφερ φτάνοντας σε dead end δεν έχει πού να πάει ("has nowhere to go").
    *   Στην εξίσωση `r = M * r`: η "συνολική σημασία" αθροίζεται στις dead ends στήλες και "χάνεται" από το σύστημα. Ο πίνακας Μ δεν είναι πλέον column stochastic (το άθροισμα στηλών μπορεί να είναι < 1), και η συνολική βαθμολογία PageRank "διαρρέει" (leaks out), μειώνοντας το άθροισμα των ranks σε < 1 σε κάθε επανάληψη. Η μέθοδος δύναμης **συγκλίνει σε 0**.
*   **(2) Spider Traps (Παγίδες Αράχνης) (Διαφάνεια 21, 22):** Ένα σύνολο κόμβων όπου **όλες οι εξερχόμενες συνδέσεις παραμένουν εντός του συνόλου**. Δεν υπάρχει εξερχόμενη σύνδεση προς κόμβο εκτός της παγίδας.
    *   Στην τυχαία περιδιάβαση: ο σερφερ μπαίνοντας στην παγίδα "κολλάει" (gets stuck) μέσα σε αυτήν.
    *   Στην εξίσωση `r = M * r`: η "συνολική σημασία" αθροίζεται εντός της παγίδας και **παγιδεύεται** μέσα της. Η μέθοδος δύναμης **συγκλίνει** (υπάρχει στατική κατανομή εντός της παγίδας, 0 εκτός), αλλά η σημασία του γράφου "συμπυκνώνεται" άδικα στην παγίδα. (Διαφάνεια 22 δείχνει rank score να "παγιδεύεται" σε κόμβο m).

## **7. PageRank: Η Διατύπωση της Google - Λύση με Teleports (Διαφάνεια 17, 23, 25-29)**

*   **Λύση:** Η Google (Brin & Page) προσέθεσε έναν μηχανισμό **"Τυχαίας Τηλεμεταφοράς" (Random Teleports)**.
*   **Ιδέα Teleports (Διαφάνεια 23):** Σε κάθε βήμα, ο τυχαίος σερφερ έχει δύο επιλογές:
    1.  Με πιθανότητα **β** (συνήθως 0.8 ή 0.9), ακολουθεί μια εξερχόμενη σύνδεση ομοιόμορφα τυχαία (όπως πριν).
    2.  Με πιθανότητα **1-β**, "πηδά" (jumps) σε μια **τυχαία σελίδα** ομοιόμορφα τυχαία από *όλους τους κόμβους* του γράφου (είτε έχουν σύνδεση είτε όχι).
*   **Πώς επιλύονται τα προβλήματα (Διαφάνεια 26):**
    *   **Spider Traps:** Ο σερφερ μπορεί πάντα να **τηλεμεταφερθεί εκτός** της παγίδας (με πιθανότητα 1-β) μέσα σε λίγα βήματα.
    *   **Dead Ends:** Αν ο σερφερ φτάσει σε dead end (δεν υπάρχουν εξερχόμενες συνδέσεις), δεν έχει επιλογή 1. **Πάντα (με πιθανότητα 1.0)** τηλεμεταφέρεται σε μια τυχαία σελίδα. Αυτό "σώζει" τη συνολική βαθμολογία PageRank, καθώς δεν "διαρρέει" από τα dead ends. (Διαφάνεια 25 δείχνει προσαρμογή του πίνακα M για dead ends).
*   **Η Εξίσωση PageRank της Google (Διαφάνεια 27):** Η εξίσωση που ενσωματώνει την τυχαία τηλεμεταφορά:
    `rj = β * Σ (ri / di)` για όλους τους κόμβους `i` τέτοιους ώστε `i → j` (όπως πριν, "follow links")
    `+ (1 - β) * (1 / N)` ("jump to a random page").
    Αυτή η εξίσωση ισχύει αν το M αναφέρεται στον πίνακα για τους non-dead-end κόμβους. Αν ο γράφος περιέχει dead ends, η πλήρης διατύπωση προσαρμόζει είτε τον πίνακα Μ είτε τον τρόπο υπολογισμού. Η Google υλοποίηση συχνά απλώς αναδιανέμει τη βαθμολογία που θα χανόταν από dead ends ομοιόμορφα στους κόμβους.
*   **Ο Πίνακας Google A (The Google Matrix A) (Διαφάνεια 28, 31-34):**
    *   Η εξίσωση PageRank με teleports μπορεί να γραφτεί σε μορφή πίνακα:
        `r = A * r`
    *   Ο πίνακας `A` ορίζεται ως: `A = β * M + (1 - β) * [1/N]`
        *   `M`: Ο αρχικός στοχαστικός πίνακας για τους *non-dead-end* κόμβους (όπου οι στήλες αθροίζουν σε 1).
        *   `[1/N]`: Ένας πίνακας NxN όπου όλα τα στοιχεία είναι 1/N. Αντιπροσωπεύει τον άλμα σε *οποιονδήποτε* κόμβο. Αν υπάρχουν dead ends, ο πίνακας Α τροποποιείται περαιτέρω για να διασφαλίσει ότι είναι *πάντα* column stochastic (προσθέτοντας τη στήλη [1/N] στις στήλες των dead ends).
    *   Το πρόβλημα PageRank γίνεται πάλι η εύρεση του ιδιοδιανύσματος `r` με ιδιοτιμή 1 για τον πίνακα `A`.
*   **Υπολογισμός με Αποδοτικότητα (Διαφάνεια 30-34):**
    *   Το κλειδί βήμα είναι η μέθοδος δύναμης: `r_new = A * r_old`.
    *   Πρόβλημα: Ο πίνακας `A` είναι πυκνός (dense) λόγω του `(1-β)*[1/N]` όρου. Η αποθήκευση `Α` και ο πολλαπλασιασμός `A * r` απαιτούν Ο(Ν^2) χώρο και χρόνο, κάτι που είναι απαγορευτικό για μεγάλα Ν.
    *   Λύση: Δεν υπολογίζουμε ούτε αποθηκεύουμε τον πίνακα `A` απευθείας. Υπολογίζουμε τον πολλαπλασιασμό `A * r` χρησιμοποιώντας την **αραιή (sparse)** μορφή του πίνακα `M` (που αναπαριστά τις συνδέσεις) και προσθέτουμε τον σταθερό όρο.
        `r_new = β * (M * r_old) + (1 - β) * (1/N)`.
        Ο πολλαπλασιασμός `M * r_old` είναι αποδοτικός (Ο(αριθμός_συνδέσεων)).
    *   Σε κάθε επανάληψη:
        1.  Υπολόγισε `M * r_old`. Αυτό είναι ένα διάνυσμα `rj` = Σ (ri / di) (από κόμβους i που έχουν σύνδεση).
        2.  Πολλαπλασίασε το αποτέλεσμα με `β`.
        3.  Πρόσθεσε το σταθερό διάνυσμα `(1 - β) * (1/N)` σε κάθε στοιχείο.
        4.  Αν υπήρχαν dead ends, προσάρμοσε την τελική κατανομή για να λογαριάσεις τη "χαμένη" βαθμολογία και βεβαιώσου ότι το άθροισμα των ranks είναι 1 (Διαφάνεια 35).

## **8. HITS: Κέντρα Εξουσίας και Αυθεντίες (Hubs and Authorities) (Διαφάνεια 36-49)**

*   **Ιδέα (Διαφάνεια 37-39):** Ο αλγόριθμος HITS (αναπτύχθηκε από τον Kleinberg) προσπαθεί να βρει δύο διαφορετικούς τύπους σημαντικών σελίδων σε ένα δίκτυο (ιδιαίτερα σε δίκτυα πληροφορίας όπως το Web):
    1.  **Authorities (Αυθεντίες):** Σελίδες που είναι **πηγές χρήσιμης πληροφορίας**. "Δείχνονται" από πολλές άλλες σελίδες.
    2.  **Hubs (Κέντρα):** Σελίδες που είναι **καταλογοι συνδέσεων (link lists)** ή "experts" σε ένα θέμα. Δείχνουν (linking) σε πολλές **Authorities**.
*   **Αναδρομικός Ορισμός (Διαφάνεια 44):**
    *   Ένα καλό Hub δείχνει σε πολλές καλές Authorities.
    *   Μια καλή Authority "δείχνεται" από πολλά καλά Hubs.
*   **Μοντέλο:** Κάθε κόμβος έχει **δύο scores**: Hub score (`h`) και Authority score (`a`).
*   **Αλγόριθμος HITS (Διαφάνεια 45-47):** Βασίζεται στην αρχή της **επαναλαμβανόμενης βελτίωσης (repeated improvement)**.
    *   Αρχικοποίηση: Δίνουμε σε όλους τους κόμβους μια αρχική τιμή για το Hub score (h) και Authority score (a) (π.χ. 1/sqrt(N)).
    *   Επανάληψη μέχρι σύγκλιση:
        1.  **Authority Update:** Κάθε κόμβος αθροίζει τους Hub scores όλων των κόμβων που δείχνουν σε αυτόν. Αυτό γίνεται ο **νέος Authority score** του. `a_i = Σ (h_j)` για όλα τα `j` τέτοια ώστε `j → i`.
        2.  **Hub Update:** Κάθε κόμβος αθροίζει τους Authority scores όλων των κόμβων στους οποίους δείχνει. Αυτό γίνεται ο **νέος Hub score** του. `h_i = Σ (a_j)` για όλα τα `j` τέτοια ώστε `i → j`.
        3.  **Κανονικοποίηση:** Κανονικοποιούμε τα διανύσματα `a` και `h` (π.χ. με την L2 norm) για να μην αυξηθούν απεριόριστα.
    *   Αυτές οι δύο ενημερώσεις (Authority και Hub) γίνονται **διαδοχικά** και επαναλαμβάνονται μέχρι να συγκλίνουν οι τιμές των scores.
*   **Διατύπωση Πίνακα (Διαφάνεια 46-48):**
    *   Ορίζουμε έναν πίνακα γειτνίασης `A` όπου `A[i,j] = 1` αν `i → j`, 0 αλλιώς.
    *   Οι εξισώσεις ενημέρωσης σε μορφή πίνακα:
        *   Authority update: `a = A^T * h` (A^T: ανάστροφος του A, αντικατοπτρίζει συνδέσεις που *έρχονται*).
        *   Hub update: `h = A * a` (A: συνδέσεις που *φεύγουν*).
    *   Υποκαθιστώντας: `h = A * (A^T * h) = (A * A^T) * h`. `a = A^T * (A * a) = (A^T * A) * a`.
    *   **Σύγκλιση:** Οι αλγόριθμοι HITS συγκλίνουν σε ένα σταθερό σημείο. Τα διανύσματα `h` και `a` συγκλίνουν στα **πρωτεύοντα ιδιοδιανύσματα** των πινάκων `A * A^T` και `A^T * A` αντίστοιχα.
    *   **A * A^T:** Ο πίνακας όπου AAT[i,j] μετρά πόσους "Authorities" συν-δείχνουν οι Hubs στους οποίους δείχνουν *και οι δύο* οι κόμβοι i και j.
    *   **A^T * A:** Ο πίνακας όπου AT*A[i,j] μετρά πόσα "Hubs" συν-δείχνουν στους κόμβους Authority στους οποίους δείχνουν *και οι δύο* οι κόμβοι i και j.
*   **Παράδειγμα HITS (Διαφάνεια 49):** Εφαρμογή του αλγορίθμου σε ένα απλό παράδειγμα δικτύου (Yahoo, Amazon, M'soft, κλπ.).

## **9. Σύγκριση PageRank και HITS (Διαφάνεια 50)**

*   PageRank και HITS είναι δύο διαφορετικές λύσεις στο **ίδιο βασικό πρόβλημα**: πώς να εκτιμήσεις την "αξία" ή "σημασία" μιας εισερχόμενης σύνδεσης (in-link).
*   **PageRank:** Η αξία μιας εισερχόμενης σύνδεσης σε ένα κόμβο `v` από ένα κόμβο `u` εξαρτάται από την συνολική βαθμολογία PageRank (σημασία) του κόμβου `u` και κατανέμεται ισομερώς σε όλες τις εξερχόμενες συνδέσεις του `u`.
*   **HITS:** Η αξία μιας εισερχόμενης σύνδεσης σε ένα κόμβο Authority εξαρτάται από την Hub score (ποιότητα ως καταλόγου) του κόμβου που δείχνει.
*   **Αποτελέσματα μετά το 1998:** Ο PageRank έγινε κυρίαρχος στην κατάταξη ιστοσελίδων γενικού σκοπού. Ο HITS βρήκε εφαρμογές σε πιο συγκεκριμένα domains (π.χ. εύρεση experts, συγκεκριμένου θέματος αρχείων συνδέσεων).

## **Σημαντική Κατανοήσεις:**

*   PageRank και HITS είναι κλασικοί αλγόριθμοι για την εκτίμηση της σημασίας κόμβων σε γράφους, ιδιαίτερα για web-like structures.
*   Ο PageRank μοντελοποιεί την πιθανότητα μιας τυχαίας περιδιάβασης, ενώ ο HITS αναζητά ταυτόχρονα "Authorities" και "Hubs" που δείχνουν μεταξύ τους.
*   Και οι δύο αλγόριθμοι ανάγονται σε προβλήματα εύρεσης ιδιοδιανυσμάτων συγκεκριμένων πινάκων που μπορούν να λυθούν επαναληπτικά (μέθοδος δύναμης).
*   Η κατανόηση αυτών των αλγορίθμων είναι θεμελιώδης για πολλούς τομείς Data Science σε γράφους, συμπεριλαμβανομένης της χρήσης τους ως χαρακτηριστικών για κόμβους σε πιο σύγχρονες αναλύσεις (π.χ. Node Embeddings, όπου τα scores κεντρικότητας μπορούν να χρησιμοποιηθούν ως features).
