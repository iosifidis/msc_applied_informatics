# Ανάλυση Δεδομένων Μεταχειρισμένων Οχημάτων

Σας δίδεται ένα αρχείο δεδομένων σε μορφή csv το οποίο περιλαμβάνει δεδομένα μεταχειρισμένων οχημάτων. Καλείστε να επεξεργαστείτε τα δεδομένα αυτά χρησιμοποιώντας το Apache Spark και συγκεκριμένα το PySpark.

Η εργασία αποτελείται από 3 ζητούμενα:

## Ζητούμενο 1ο (Μονάδες 3): Βασική Επεξεργασία Δεδομένων

1. Για τις στήλες `model` και `engine` αντικαταστήστε το κενό με κάτω παύλα (underscore).
2. Μετατρέψτε τα ονόματα των `brand` σε κεφαλαία.
3. Υπολογίστε και αποθηκεύστε σε μεταβλητή το πλήθος των οχημάτων Audi με `model_year` από το 2016 ως και το 2020. Εμφανίστε το περιεχόμενο της μεταβλητής.
4. Μετατρέψτε από δολάρια που είναι το νόμισμα στη στήλη `price` σε ευρώ (ισοτιμία 1$ = 0.9€). Μετατρέψτε το `mileage` από μίλια σε χιλιόμετρα. Αποθηκεύστε το νέο dataframe σε csv.
5. Υπολογίστε και αποθηκεύστε σε αρχείο csv το πλήθος των οχημάτων ανά μάρκα (`brand`) που πωλούνται.

## Ζητούμενο 2ο (Μονάδες 6): Δημιουργία Πίνακα Στατιστικών

Δημιουργήστε πίνακα στατιστικών για το αρχείο csv, ο οποίος θα αποθηκευτεί επίσης σε αρχείο csv. Υπολογίστε κατά μάρκα και κατά μοντέλο, ταυτόχρονα:

1. Το μέσο κόστος των οχημάτων
2. Το πλήθος των οχημάτων
3. Τον καλύτερο (χαμηλότερο) δείκτη αξίας: Γινόμενό `Mileage * price` για το συγκεκριμένο συνδυασμό μοντέλο και μάρκας.

## Ζητούμενο 3ο (Μονάδα 1): Χρήση του Apache Spark Structured Streaming API

Υπολογίστε και πάλι τα στατιστικά του ζητουμένου 2, χρησιμοποιώντας Apache Spark Structured Streaming. Να τοποθετήσετε το csv αρχείο που προκύπτει από τη web εφαρμογή σε κατάλληλο φάκελο, να ενημερώσετε με το συγκεκριμένο μηχανισμό τον πίνακα στατιστικών του ζητουμένου 2 και να αποθηκεύσετε τον νέο πίνακα στατιστικών σε csv αρχείο.

## Οδηγίες

Το csv αρχείο που θα χρησιμοποιήσετε ως είσοδο έχει τα παρακάτω πεδία:

*   `brand`: Μάρκα (Κατασκευαστής)
*   `model`: Μοντέλο
*   `model_year`: Έτος κυκλοφορίας / Μοντέλο έτους
*   `milage`: Χιλιόμετρα (Διανυθείσα απόσταση)
*   `fuel_type`: Τύπος καυσίμου (π.χ. Βενζίνη, Πετρέλαιο)
*   `engine`: Κινητήρας (Κυβισμός/Ιπποδύναμη)
*   `transmission`: Σύστημα μετάδοσης (Κιβώτιο ταχυτήτων)
*   `ext_col`: Εξωτερικό χρώμα
*   `int_col`: Εσωτερικό χρώμα (Σαλόνι)
*   `accident`: Ιστορικό ατυχημάτων
*   `clean_title`: Καθαρός τίτλος ιδιοκτησίας (Χωρίς νομικά βάρη ή ολική καταστροφή)
*   `price`: Τιμή

## Διευκρινίσεις

1. Η εργασία είναι ατομική.
2. Για την υλοποίησή της θα πρέπει να χρησιμοποιήσετε Python και κάποιο από τα APIs που προσφέρει το Apache Spark (RDD, Spark Dataframe, Spark SQL).
3. Δεν θα πρέπει να χρησιμοποιήσετε εξωτερικές βιβλιοθήκες (π.χ. Pandas). Σε αυτή την περίπτωση δεν θα βαθμολογηθείτε.
4. Θα παραδώσετε:
    *   4.1. Τα αρχεία κώδικά σας.
    *   4.2. Μία αναφορά, έως 3 σελίδες, με οδηγίες εκτέλεσης της εφαρμογής σας, τα προβλήματα που αντιμετωπίσετε και τους τρόπους επίλυσής τους.
5. Η εργασία θα πρέπει να παραδοθεί ηλεκτρονικά μέσω openeclass σε μορφή ενός αρχείου zip.
